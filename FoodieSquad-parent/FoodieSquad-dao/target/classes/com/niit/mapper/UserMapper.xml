<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.niit.mapper.UserMapper">
  <resultMap id="BaseResultMap" type="com.niit.pojo.User">
    <id column="user_id" jdbcType="INTEGER" property="userId" />
    <result column="user_student_num" jdbcType="VARCHAR" property="userStudentNum" />
    <result column="user_name" jdbcType="VARCHAR" property="userName" />
    <result column="user_password" jdbcType="VARCHAR" property="userPassword" />
    <result column="user_gender" jdbcType="CHAR" property="userGender" />
    <result column="user_balance" jdbcType="DECIMAL" property="userBalance" />
     <result column="user_income" jdbcType="DECIMAL" property="userIncome" />
    <result column="user_type" jdbcType="INTEGER" property="userType" />
  
    <collection column="user_tele_id" jdbcType="VARCHAR" ofType="com.niit.pojo.UserTele" property="userTele">
    <id column="user_tele_id" jdbcType="INTEGER" property="userTeleId" />
    <id column="user_id" jdbcType="INTEGER" property="userId" />
    <result column="user_tele" jdbcType="VARCHAR" property="userTele" />
    </collection>
    <collection column="user_address" jdbcType="VARCHAR" ofType="com.niit.pojo.UserAddress" property="userAddress">
     <id column="user_address_id" jdbcType="INTEGER" property="userAddressId" />
    <id column="user_id" jdbcType="INTEGER" property="userId" />
    <result column="user_address" jdbcType="VARCHAR" property="userAddress" />
    </collection>
  </resultMap>

 
 <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
   delete from user where user_id=#{userId,jdbcType=INTEGER};
 </delete> 
  
<insert id="insert" parameterType="com.niit.pojo.User">
    insert into user (user_id, user_student_num, user_name, 
      user_password, user_gender, user_balance, 
      user_type, user_address_id, 
      user_tele_id,user_income)
    values (#{userId,jdbcType=INTEGER}, #{userStudentNum,jdbcType=VARCHAR}, #{userName,jdbcType=VARCHAR}, 
      #{userPassword,jdbcType=VARCHAR}, #{userGender,jdbcType=CHAR}, #{userBalance,jdbcType=DECIMAL}, 
      #{userType,jdbcType=INTEGER},#{userId,jdbcType=INTEGER}, 
    #{userId,jdbcType=INTEGER},#{userIncome,jdbcType=DECIMAL})
  </insert>
  
  
  
<update id="updateByPrimaryKey" parameterType="com.niit.pojo.User">
    update user
    set user_student_num = #{userStudentNum,jdbcType=VARCHAR},
      user_name = #{userName,jdbcType=VARCHAR},
      user_password = #{userPassword,jdbcType=VARCHAR},
      user_gender = #{userGender,jdbcType=CHAR},
      user_balance = #{userBalance,jdbcType=DECIMAL},
      user_income=#{userIncome,jdbcType=DECIMAL},
      user_type = #{userType,jdbcType=INTEGER}
     where user_id = #{userId,jdbcType=INTEGER}
</update>



 <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
 select 
     u.user_id, u.user_student_num,u. user_name, 
     u. user_password,  u.user_gender, 
     u.user_balance, u.user_type, 
     u.cart_id,u.user_income,ut.*,ua.*
    from user u
     left join user_tele ut on ut.user_id=u.user_id
     left join user_address ua on ua.user_id=u.user_id
    where u.user_id = #{userId,jdbcType=INTEGER}
    
</select>



 <select id="selectByUserType" parameterType="java.lang.Integer" resultMap="BaseResultMap">
 select * from user 
    where user_type = #{userType,jdbcType=INTEGER}
</select>



   <select id="selectAll" resultMap="BaseResultMap">
   select *
    from user u 
 </select> 

 <select id="selectByStuNumAndPwd" parameterType="map" resultMap="BaseResultMap">
        select * from user u where u.user_student_num=#{userStudentNum,jdbcType=VARCHAR} and u.user_password=#{userPassword,jdbcType=VARCHAR}
    </select>
 
</mapper>